\documentclass[12pt]{article}

\usepackage{amsmath}

\input{../../tex/preamble.tex}

\begin{document}
\makemytitlepage{3}{Классификация и кластеризация изображений на GPU.}

\se{Цель работы}

Научиться использовать GPU для классификации и
кластеризации изображений. Использование константной памяти.

\textbf{Вариант 5.} Метод k-средних.

\textbf{Входные данные.}
На первой строке задается путь к исходному изображению,
на второй, путь к конечному изображению. На следующей строке, число $nc$ -- кол-во
кластеров. Далее идут $nc$ строчек описывающих начальные центры кластеров. Каждая
i-ая строчка содержит пару чисел -- координаты пикселя который является центром.
$nc <= 32$.

\nvidia

\se{Метод решения}


\se{Описание программы}



{
	\scriptsize
	\listsource{../src}{main.cu}
}

\newpage

\se{Результаты}


\begin{figure}[tbh]
	\caption*{Малое изображение: 400x408}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\caption*{Исходное изображение}
		\includegraphics[scale=0.4]{../test/images/nigger.png}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\caption*{Результат:}
		\includegraphics[scale=0.4]{../test/t3/res.png}
	\end{subfigure}
\end{figure}

Были выделены пиксели с отдельных лепестков и из центральной области.

\begin{figure}[tbh]
	\caption*{Большое изображение: 6000x4000}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\caption*{Исходное изображение}
		\includegraphics[scale=0.159]{../test/images/pumpkin.png}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\caption*{Результат:}
		\includegraphics[scale=0.038]{../test/t4/res.png}
	\end{subfigure}
\end{figure}

Были выделены пиксели на облаке, чистом небе, тыкве и соломе.
Но так получилось что цвет соломы оказался несколько ближе к цвету тыквы.

\textit{Время указано в миллисекундах}


% \begin{center}
% 	cpu time = 348.877649
% 	\begin{table*}[!htb]
% 		\centering
% 		\begin{tabular}{|c|c|c|}
% 			\hline
% 			blocks    & threads & time        \\
% 			\hline
% 			16x16     & 16x16   & 005.450240  \\
% 			32x32     & 16x16   & 005.528064  \\
% 			8x8       & 8x8     & 005.688256  \\
% 			16x16     & 32x32   & 005.862272  \\
% 			64x64     & 16x16   & 005.932992  \\
% 			32x32     & 32x32   & 006.667456  \\
% 			4x4       & 4x4     & 021.764448  \\
% 			1024x1024 & 16x16   & 031.003839  \\
% 			1024x1024 & 32x32   & 204.964478  \\
% 			1x1       & 1x1     & 3699.413574 \\
% 			\hline
% 		\end{tabular}
% 	\end{table*}
% \end{center}


\se{Выводы}

Я понял что обрабатывать изображения на CPU плохая идея, если даже на одном небольшом изображении
разница получилась в 64 раза.

Конкретно выделение контуров было мне нужно для подготовки данных для обучения нейросети.
Нужно было разделить изображение на несколько по указанным линиям.
Правда там я использовал повышение контраста и резкости,
но чувствую было бы проще если бы я использовал предназначенный для этого алгоритм.

\end{document}